# LicDataExtractor

Извлечение регистрационных данных клиента из файла программной лицензии 1С Предприятия.

Утилита пишется по просьбе коллег.

Назначение: извлечение регистрационных данных клиента из файла программной лицензии системы 1С Предприятия.

Технология: Java, JavaFX.

Описание механизма получения данных: http://gogprog.ru/rabota_s_licenziyami_i_klyuchami_1s/license-info-1c.html

По сути, используется консольная утилита ring, распространяемая в составе дистрибутива платформы 1С: Предприятие.

LicDataExtractor служит лишь оберткой над этой утилитой, добавляя следующие удобства:

- нет необходимости использовать командную строку для получения данных;
- регистрационные данные, извлеченные из файла лицензии, показываются на экране, откуда могут быть скопированы;
- регистрационные данные также сохраняются в текстовый файл рядом с файлом лицензии.

Ограничения:

- для работы утилиты необходим установленный JRE 1.8 или выше.
- рекомендуется создать временную папку, куда нужно скопировать исследуемый файл лицензии. В папке одновременно может находиться только
  один файл лицензии. Возможно, в будущем это ограничение будет устранено, но пока так.
  
Подготовка к работе:

- выполнить инструкции из статьи http://gogprog.ru/rabota_s_licenziyami_i_klyuchami_1s/license-info-1c.html (шаги 1-4);
- создать временные папки на диске, куда скопировать файлы программных лицензий. В каждой папке должен быть один файл лицензии.
- запустить LicDataExtractor, нажать на кнопку выбора директории и выбрать папку со скопированным файлом лицензии.

Статус: релиз 1.00.

Примечания: 

Первоначально был написан короткий скрипт на PowerShell. Однако, при его работе были выявлены 2 проблемы:

- по умолчанию, запуск скриптов PowerShell в Windows запрещен по соображениям безопасности. Поэтому для запуска скрипта нужно
  сначала разрешить его выполнение, а после того, как скрипт отработает, вернуть данную политику в исходное. Проблема была решена
  запуском скрипта не напрямую, а с помощью специально написанного bat-файла. Данное решение вполне себе работает, но выглядит
  как-то неаккуратненько. Решать же задачу с помощью только bat-файла мне было неинтересно. Кроме того, хотелось сделать красиво, 
  с окном выбора папок, а в bat-файлах так не сделаешь (или я не знаю, как);
- возникли сложности при запуске скрипта на Windows XP. Для работа скрипта понадобилось установить .Net Framework 2.0, затем 
  .Net Framework 3.5, затем собственно PowerShell. Мне крайне сложно представить себе человека, который будет этим заниматься
  в здравом уме и твердой памяти. На Windows 7/10 все работает "из коробки". Предполагается, что и на Windows 8/8.1 и на
  Windows Server 2008/2012/2016 все должно работать нормально, но не тестировал.
  
С другой стороны, ring требует для работы установленный JRE, так что использование Java выглядит вполне логичным.

Отказ от ответственности: утилита предоставляется "как есть", автор не несет ответственности за любые проблемы, связанные 
с ее использованием. Хотя и не может такие проблемы себе представить.

Утилита разрабатывается в свободное время, любые замечания и пожелания будут с вниманием/благодарностью выслушаны/прочитаны, 
но не факт, что к чему-то приведут.



Downloads: https://github.com/miller7777777/LicDataExtractor/releases/tag/1.00 
